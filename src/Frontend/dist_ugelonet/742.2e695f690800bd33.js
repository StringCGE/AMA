"use strict";(self.webpackChunkFundacion=self.webpackChunkFundacion||[]).push([[742],{3742:(G,g,i)=>{i.r(g),i.d(g,{DonorModule:()=>K});var x=i(6814),l=i(6223),f=i(7573),U=i(617),v=i(9250),u=i(707),y=i(3965),A=i(1312),p=i(5219),b=i(3904),m=i(4104),Z=i(5959),t=i(9212),C=i(595),S=i(1282),D=i(5619);let F=(()=>{class r{constructor(){this.filtroSubject=new D.X({}),this.filtro$=this.filtroSubject.asObservable()}actualizarFiltro(e){this.filtroSubject.next(e)}static#t=this.\u0275fac=function(o){return new(o||r)};static#e=this.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var L=i(553),h=i(6306),N=i(8504),P=i(9862);let I=(()=>{class r{constructor(e){this.http=e,this.apiUrl=L.N.serverAma+"api/donor",this.donorListSubject=new D.X([])}getDonorList(){return this.http.get(this.apiUrl).pipe((0,h.K)(e=>(console.error("Error al obtener la lista de donantes:",e),(0,N._)(e))))}postDonor(e){return this.http.post(this.apiUrl,e).pipe((0,h.K)(o=>{throw console.error("Error al agregar el donante:",o),o}))}updateDonor(e,o){return this.http.put(`${this.apiUrl}/${e}`,o).pipe((0,h.K)(s=>{throw console.error("Error al actualizar el donante:",s),s}))}deleteDonor(e){return this.http.delete(`${this.apiUrl}/${e}`)}static#t=this.\u0275fac=function(o){return new(o||r)(t.LFG(P.eN))};static#e=this.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var z=i(5118),E=i(3620),O=i(3997);let w=(()=>{class r{constructor(e,o){this.fb=e,this.filterService=o}ngOnInit(){this.filtroForm=this.fb.group({nombreFiltro:[""],numeroFiltro:[""]}),this.filtroForm.valueChanges.pipe((0,E.b)(300),(0,O.x)()).subscribe(e=>{this.filterService.actualizarFiltro(e)})}static#t=this.\u0275fac=function(o){return new(o||r)(t.Y36(l.qu),t.Y36(F))};static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["app-donor-filter"]],decls:17,vars:1,consts:[[1,"card"],[1,"card-header"],[1,"mb-0"],[1,"card-body"],[3,"formGroup"],[1,"row"],[1,"col-md-3"],[1,"form-group"],["for","nombreFiltro"],["type","text","id","nombreFiltro","formControlName","nombreFiltro",1,"form-control","form-control-sm"],["for","numeroFiltro"],["type","text","id","numeroFiltro","formControlName","numeroFiltro","maxlength","10",1,"form-control","form-control-sm"]],template:function(o,n){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h5",2),t._uU(3,"Filtros"),t.qZA()(),t.TgZ(4,"div",3)(5,"form",4)(6,"div",5)(7,"div",6)(8,"div",7)(9,"label",8),t._uU(10,"Filtrar por Nombre:"),t.qZA(),t._UZ(11,"input",9),t.qZA()(),t.TgZ(12,"div",6)(13,"div",7)(14,"label",10),t._uU(15,"Filtrar por Numero de Identificacion:"),t.qZA(),t._UZ(16,"input",11),t.qZA()()()()()()),2&o&&(t.xp6(5),t.Q6J("formGroup",n.filtroForm))},dependencies:[l._Y,l.Fj,l.JJ,l.JL,l.nD,l.sg,l.u]})}return r})();function Y(r,T){1&r&&(t.TgZ(0,"tr",14)(1,"th",15),t._uU(2,"ID"),t.qZA(),t.TgZ(3,"th"),t._uU(4,"Identificacion"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Nombre"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Celular"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Email"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Status"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Acciones"),t.qZA()())}const j=()=>({"border-radius":"5px","font-size":"10px",height:"2.3rem",width:"2.4rem"});function J(r,T){if(1&r){const e=t.EpF();t.TgZ(0,"tr",14)(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td")(14,"div",16)(15,"button",17),t.NdJ("click",function(){const s=t.CHM(e).$implicit,a=t.oxw();return t.KtG(a.EditData(s.person))}),t._UZ(16,"i",18),t.qZA(),t.TgZ(17,"p-button",19),t.NdJ("click",function(n){const a=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.confirmacionEliminar(n,a))}),t.qZA()()()()}if(2&r){const e=T.$implicit;t.xp6(2),t.Oqu(e.person.id),t.xp6(2),t.Oqu(e.person.identification),t.xp6(2),t.Oqu(e.person.nameCompleted),t.xp6(2),t.Oqu(e.person.phone),t.xp6(2),t.Oqu(e.person.email),t.xp6(2),t.Oqu(e.status?"A":"I"),t.xp6(5),t.Akn(t.DdM(8,j))}}const q=()=>[10,25,50],M=()=>["identification","nameCompleted"];let R=(()=>{class r{EditData(e){this.NavigateUpdate(e)}constructor(e,o,n,s,a,c){this.filterService=e,this.donorService=o,this.dialogService=n,this.personService=s,this.messageService=a,this.confirmationService=c,this.isUpdateListDetails=!1,this.loading=!1,this.listaPersonas=[],this.totalRows=0,this.donorList=[],this.donorListFiltered=[],this.numeroDeClicks=0}ngOnInit(){this.getPerson(),this.donorService.getDonorList().subscribe(e=>{this.donorList=e.result,this.filterService.filtro$.subscribe(o=>{this.aplicarFiltros(o)}),this.aplicarFiltros({nombreFiltro:"",numeroFiltro:null})},e=>{console.error("Error al obtener datos:",e)})}handleUpdateListDetails(){this.getPerson()}ngOnChanges(e){console.log(e);for(let o in e)"isUpdateListDetails"===o&&this.handleUpdateListDetails()}getPerson(){this.personFiler={offset:0,take:10,sort:""},this.personService.getAllPersons(this.personFiler).subscribe(e=>{this.listaPersonas=e.result,this.totalRows=e.length,this.loading=!1},e=>{})}NavigateUpdate(e){this.dialogService.open(S.u,{header:"Crear Donante",width:"75%",height:"85%",data:{update:!0,person:e},contentStyle:{"max-height":"500px",overflow:"auto"},baseZIndex:1e4}).onClose.subscribe(o=>{o&&this.getPerson()})}loadDetailsLazy(e){let o=e.sortField,s=e.first,a=e.rows,c="";if(null!=o){let d=[];d.push({selector:o,desc:1!==e.sortOrder}),c=JSON.stringify(d)}this.personFiler.sort=c,this.personFiler.take=a,this.personFiler.offset=s,this.personService.getAllPersons(this.personFiler).subscribe(d=>{this.listaPersonas=d.result,this.totalRows=d.length,this.loading=!1},d=>{})}aplicarFiltros(e){const{nombreFiltro:o,numeroFiltro:n}=e;this.donorListFiltered=this.donorList.filter(s=>{const a=!o||this.removerTildes(s.nombreCompleto.toLowerCase()).includes(this.removerTildes(o.toLowerCase())),c=!n||s.identificacion.toString().includes(n.toString());return a&&c})}removerTildes(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}eliminarDonante(e){this.donorService.deleteDonor(e).subscribe(o=>{this.getPerson(),this.messageService.add({severity:"info",summary:"Confirmado",detail:"Donante eliminado exitosamente"})},o=>{this.messageService.add({severity:"error",summary:"Error",detail:"Error al eliminar el donante"})})}confirmacionEliminar(e,o){this.numeroDeClicks++,console.log("\u{1f680} ~ TuComponente ~ confirmacionEliminar ~ numeroDeClicks:",this.numeroDeClicks),this.confirmationService.confirm({target:e.target,message:"\xbfDesea eliminar este registro?",header:"Confirmaci\xf3n de Eliminaci\xf3n",icon:"pi pi-info-circle",acceptButtonStyleClass:"p-button-danger p-button-text",rejectButtonStyleClass:"p-button-text p-button-text",acceptIcon:"none",rejectIcon:"none",accept:()=>{console.log("eliminado")},reject:()=>{this.messageService.add({severity:"error",summary:"Rechazado",detail:"Eliminacion Cancelada"})}})}static#t=this.\u0275fac=function(o){return new(o||r)(t.Y36(F),t.Y36(I),t.Y36(z.xA),t.Y36(C.R),t.Y36(p.ez),t.Y36(p.YP))};static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["app-donor-list"]],inputs:{isUpdateListDetails:"isUpdateListDetails"},features:[t.TTD],decls:18,vars:8,consts:[[1,"content"],[1,"container-fluid"],[1,"row"],[1,"col-12"],[3,"filtroChanged"],[1,"row","mt-3"],[1,"card"],[1,"card-header"],[1,"mb-0"],[1,"card-body"],[1,"table-responsive"],["dataKey","id","currentPageReportTemplate","Mostrando {first} al {last} de {totalRecords} registros",1,"table-responsivecell-border","table","table-striped","table-bordered","table-sm",3,"value","rows","showCurrentPageReport","rowsPerPageOptions","paginator","globalFilterFields"],["pTemplate","header"],["pTemplate","body"],[2,"font-size","14px"],[2,"width","5%"],[1,"btn-group",2,"display","flex","align-items","center","font-size","10px"],[1,"p-button","p-button-rounded","p-button-warning","p-button-icon-only",2,"margin-right","5px","border-radius","5px","height","2.3rem","width","2.4rem",3,"click"],[1,"pi","pi-pencil",2,"font-size","10px"],["icon","pi pi-trash","styleClass","p-button-danger p-button-rounded p-button-icon-only",3,"click"]],template:function(o,n){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"app-donor-filter",4),t.NdJ("filtroChanged",function(a){return n.aplicarFiltros(a)}),t.qZA()()(),t.TgZ(5,"div",5)(6,"div",3)(7,"div",6)(8,"div",7)(9,"h5",8),t._uU(10,"Lista de Donantes"),t.qZA()(),t.TgZ(11,"div",9)(12,"div",10)(13,"p-table",11),t.YNc(14,Y,15,0,"ng-template",12)(15,J,18,9,"ng-template",13),t.qZA(),t._UZ(16,"p-toast")(17,"p-confirmDialog"),t.qZA()()()()()()()),2&o&&(t.xp6(13),t.Q6J("value",n.donorListFiltered)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(6,q))("paginator",!0)("globalFilterFields",t.DdM(7,M)))},dependencies:[v.iA,p.jx,u.zx,m.FN,b.Q,w]})}return r})();const $=[{path:"",component:(()=>{class r{constructor(e,o){this.dialog=e,this.personDonorService=o,this.visible=!1}ngOnInit(){}callNavigateToCreate(){this.personDonorService.triggerCreateDonor()}closeDialog(){this.visible=!1}static#t=this.\u0275fac=function(o){return new(o||r)(t.Y36(f.uw),t.Y36(C.R))};static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["app-donor-index"]],decls:13,vars:0,consts:[[1,"content"],[1,"container-fluid"],[1,"panel","panel-default"],[1,"panel-heading","header-general"],[1,"panel-title"],["pButton","","type","button","icon","pi pi-user","label","Ingresar Nuevo Donante",1,"btn","btn-primary","btn-sm",3,"click"],["role","group","aria-label","Icon Buttons",1,"btn-group"],[1,"panel-body"],[1,"contenedor-filtro","row","pb-4"],[1,"donor-list-container"]],template:function(o,n){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3",4),t._uU(5,"Donantes"),t.qZA(),t._UZ(6,"p-toast"),t.TgZ(7,"button",5),t.NdJ("click",function(){return n.callNavigateToCreate()}),t.qZA(),t._UZ(8,"div",6),t.qZA(),t.TgZ(9,"div",7),t._UZ(10,"div",8),t.TgZ(11,"div",9),t._UZ(12,"app-donor-list"),t.qZA()()()()())},dependencies:[u.Hq,m.FN,R]})}return r})()}];let B=(()=>{class r{static#t=this.\u0275fac=function(o){return new(o||r)};static#e=this.\u0275mod=t.oAB({type:r});static#o=this.\u0275inj=t.cJS({imports:[Z.Bz.forChild($),Z.Bz]})}return r})(),K=(()=>{class r{static#t=this.\u0275fac=function(o){return new(o||r)};static#e=this.\u0275mod=t.oAB({type:r});static#o=this.\u0275inj=t.cJS({providers:[p.ez,p.YP],imports:[x.ez,l.UX,B,f.Is,U.Ps,v.U$,u.hJ,y.kW,l.u5,A.S,m.EV,b.D]})}return r})()}}]);